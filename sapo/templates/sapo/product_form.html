
{% extends 'main.html' %}
{% load static %}
{% block content %}
<style>
    body {
        background-color: rgb(231, 231, 231);
    }
</style>
<form id="post_form" enctype="multipart/form-data" >
    {% csrf_token %}
<nav class="navbar navbar-expand-lg navbar-light bg-light" style="position: absolute; top: 0; left: 249px; right: 0; z-index: 1000;">
  <div class="container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand nav-link btn btn-outline-secondary " href="{% url 'product_list' %}" style="margin-left: auto;font-family: 'Roboto', sans-serif;"><i class="bi bi-caret-left-fill me-2"></i><strong>Quay lại danh sách sản phẩm</strong></a>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <div class="navbar-nav ms-auto">
        <a class="btn btn-outline-danger me-3" href="{% url 'product_list' %}" role="button">Thoát</a>
        <button class="btn btn-primary me-3" type="button">Lưu và in mã vạch</button>
        <input type="submit" value="Lưu" class="btn btn-success me-3">
    </div>
  </div>
</nav>
<!-- -------------------------------------------------------------------- -->
<div class="container-fluid mt-5" style="border: 1px solid white; border-radius: 5px; padding: 50px; background-color: white; width: 66%; float: left;">
    <h5>Thông tin chung</h5>
    <hr>
    <div class="container-fluid mt-3">
            <div class="mb-3">
                <label for="name" class="form-label">Tên sản phẩm</label>
                <input type="text" class="form-control" id="name" name="name" autocomplete="name" required>
            </div>
                <div class="mb-3 row">
                    <div class="col">
                        <label for="id_mass" class="form-label">Khối lượng</label>
                        <input type="number" class="form-control" id="id_mass" name="id_mass" >
                    </div>
                    <div class="col">
                        <label for="id_unit" class="form-label">Đơn vị tính</label>
                        <input type="text" class="form-control" id="id_unit" name="id_unit" >
                    </div>
                </div>
            <div class="mb-3 row">
                <div class="col">
                    <label for="id_code" class="form-label">Mã sản phẩm/SKU</label>
                    <input type="text" class="form-control" id="id_code" name="id_code" >
                </div>
                <div class="col">
                    <label for="id_qr_code" class="form-label">Mã vạch/Barcode</label>
                    <input type="text" class="form-control" id="id_qr_code" name="id_qr_code" >
                </div>
            </div>

        
    </div>
</div>

<!-- -------------------------------------------------------------- -->
<div class="container-fluid mt-5 ms-5" style="border: 1px solid white; border-radius: 5px; padding: 20px; background-color: white; width: 30%; float: left;">
    <h5>Thông tin khác</h5>
    <hr>
    <div class="container-fluid mt-3>">
            <div class="mb-3 row">
                <div class="col">
                    <label for="id_category" class="form-label">Loại sản phẩm</label>
                    <select class="form-select" id="id_category" name="id_category" >
                        <option value="" selected disabled>-- Chọn loại sản phẩm --</option>
                        {% for category in categories %}
                            <option value="{{ category.id }}">{{ category.name }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="mb-3 row">
                <div class="col">
                    <label for="id_brand" class="form-label">Nhãn hiệu</label>
                    <select class="form-select" id="id_brand" name="id_brand" >
                        <option value="" selected disabled>-- Chọn nhãn hiệu --</option>
                        {% for brand in brands %}
                            <option value="{{ brand.id }}">{{ brand.name }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="mb-3 row">
                <div class="col">
                    <label for="id_tag" class="form-label">Tags</label>
                    <textarea class="form-control" id="id_tag" style="height: 100px"></textarea>
            </div>
        </div>
    </div>
</div>

<!-- -------------------------------------------------------------- -->
<div class="container-fluid mt-5" style="border: 1px solid white; border-radius: 5px; padding: 20px; background-color: white; width: 66%; float: left;">
    <h5>Giá sản phẩm</h5>
    <hr>
    <div class="container-fluid mt-3">
            <div class ="row">
                <div class="col">
                    <div class="mb-3">
                        <label for="id_retail_price" class="form-label">Giá bán lẻ</label>
                        <input type="decimal" class="form-control" id="id_retail_price" name="id_retail_price" value="0">
                    </div>
                </div>
                <div class="col">
                    <div class="mb-3">
                        <label for="id_wholesale_price" class="form-label">Giá bán sỉ</label>
                        <input type="decimal" class="form-control" id="id_wholesale_price" name="id_wholesale_price" value="0">
                    </div>
                </div>
                <hr>
                <div class="mb-3">
                    <label for="id_import_price" class="form-label">Giá nhập</label>
                    <input type="decimal" class="form-control" id="id_import_price" name="id_import_price" value="0" >
                </div>
            </div>
    </div>
</div>


<!-- -------------------------------------------------------------- -->
<div class="container-fluid mt-5 ms-10" style="border: 1px solid white; border-radius: 5px; padding: 5px; background-color: white; width: 30%; float: right;">
    <div class="container-fluid mt-3">
<div class="row">
    <div class="col">
        <label for="id_image" class="form-label">
            Ảnh sản phẩm
        </label>
        <input class="form-control" type="file" id="id_image" name="id_image" >
        <img src="path/to/your/default/image.jpg" alt="Ảnh sản phẩm mặc định" id="preview_image" style="margin-top: 10px; max-height: 100px;">
        <script>
            document.getElementById('id_image').onchange = evt => {
                const [file] = document.getElementById('id_image').files;
                if (file) {
                    document.getElementById('preview_image').src = URL.createObjectURL(file);
                } else {
                    // Set to your default image if no image is selected
                    document.getElementById('preview_image').src = 'path/to/your/default/image.jpg';
                }
            }
        </script>
    </div>
</div>
            <hr>
            <div class="row">
                <div class="col">
                    <label for="id_status" class="form-label">
                        Trạng thái<br>
                        (có thể bán)
                    </label>
                </div>
                <div class="col-auto">
                    <div class="form-check form-switch">
                        <br><input class="form-check-input" type="checkbox" id="id_status" name="id_status" {% if form.id_status.value %}checked{% endif %}>
                        <label class="form-check-label" for="id_status"></label>
                    </div>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col">
                    <label for="id_tax" class="form-label">
                        Thuế<br>
                        (có thuế)
                    </label>
                </div>
                <div class="col-auto">
                    <div class="form-check form-switch">
                        <br><input class="form-check-input" type="checkbox" id="id_tax" name="id_tax" {% if form.id_tax.value %}checked{% endif %}>
                        <label class="form-check-label" for="id_tax"></label>
                    </div>
                </div>
            </div>                           
    </div>
    
</div>
</form>



<Script type="text/javascript">
    $(document).on("submit", "#post_form", function(e) {
              e.preventDefault();
              $.ajax({
                type: "POST",
                url: "/add_product/",
                
                data: {
                    name: $("#name").val(),
                    code: $("#id_code").val(),
                    category: $("#id_category").val(),
                    brand: $("#id_brand").val(),
                    stock: $("#id_stock").val(),
                    retail_price: $("#id_retail_price").val(),
                    wholesale_price: $("#id_wholesale_price").val(),
                    import_price: $("#id_import_price").val(),
                    description: $("#id_description").val(),
                    unit: $("#id_unit").val(),
                    mass: $("#id_mass").val(),
                    image: $("#id_image").val(),
                    status: $("#id_status").is(":checked") ? "True" : "False",
                    tax: $("#id_tax").is(":checked") ? "True" : "False",
 
                    

                    csrfmiddlewaretoken: $("input[name=csrfmiddlewaretoken]").val(),
                },
                success: function(data) {
                    alert(data);
                },
                
                
            })
        })
        </Script>
        
        
        
        {% endblock content %}
        <!-- <!DOCTYPE html>
        <html>
            <head>
                <meta charset="utf-8">
                <meta http-equiv="X-UA-Compatible" content="IE=edge">
                <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
                <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
                <title></title>
                <meta name="description" content="">
                <meta name="viewport" content="width=device-width, initial-scale=1">
                <link rel="stylesheet" href="">
            </head>
            <body>
                <h1></h1>
                <script>
                    $(document).ready(function() {
                      $("input").addClass("form-control")
                      $("label").addClass("col-sm-2 control-label");
        
                    });
                  </script>
                  <form id="post_form"  class="form-horizontal">
                    {% csrf_token %}
                    <h2>Add Product</h2>
                    <div class="form-group">
                      <label for="name" >Name</label>
                      <div class="col-sm">
                        <input type="text" name="name" id="name"  placeholder="Enter name" >
                      </div>
                    </div>
                    <div class="form-group">
                      <label for="code" ></label>
                      <div class="col-sm">
                        <input type="text" name="code" id="code" placeholder="Enter code" >
                      </div>
                    </div>
        
                    <div class="form-group">
                      <div class="col-sm-offset-2 col-sm">
                        <input type="submit" value="submit" class="btn btn-primary">
                      </div>
                    </div>
                  </form>
                   -->

